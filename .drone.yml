clone:
  git:
    image: plugins/git:next
workspace:
  base: /test
  path: downstream
matrix:
  PHP_VERSION:
    - 56
    - 71
pipeline:
  setup:
    image: fpfis/php${PHP_VERSION}-build
    group: setup
    commands:
      - composer require ec-europa/toolkit:dev-develop --ansi --no-suggest
      - PROJECT=$(pwd) composer run-script toolkit-install -d ./vendor/ec-europa/toolkit
    volumes:
      - /cache/${DRONE_REPO_NAME}:/cache
  ec-europa/euetfa-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/euetfa-reference.git -b master
      - rm euetfa-reference/build.project.xml
      - ./toolkit/phing -f euetfa-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/europaeu-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/europaeu-reference.git -b master
      - rm europaeu-reference/build.project.xml
      - ./toolkit/phing -f europaeu-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/ewrc-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/ewrc-reference.git -b master
      - rm ewrc-reference/build.project.xml
      - ./toolkit/phing -f ewrc-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/horizon2020-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/horizon2020-reference.git -b master
      - rm horizon2020-reference/build.project.xml
      - ./toolkit/phing -f horizon2020-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/maritimeforum-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/maritimeforum-reference.git -b master
      - rm maritimeforum-reference/build.project.xml
      - ./toolkit/phing -f maritimeforum-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/stages2-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/stages2-reference.git -b master
      - rm stages2-reference/build.project.xml
      - ./toolkit/phing -f stages2-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/srb-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/srb-reference.git -b master
      - rm srb-reference/build.project.xml
      - ./toolkit/phing -f srb-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/eu-aid-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/eu-aid-reference.git -b master
      - rm eu-aid-reference/build.project.xml
      - ./toolkit/phing -f eu-aid-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/kci-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/kci-reference.git -b master
      - rm kci-reference/build.project.xml
      - ./toolkit/phing -f kci-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/farnet-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/farnet-reference.git -b master
      - rm farnet-reference/build.project.xml
      - ./toolkit/phing -f farnet-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/digital-agenda-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/digital-agenda-reference.git -b master
      - rm digital-agenda-reference/build.project.xml
      - ./toolkit/phing -f digital-agenda-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/health-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/health-reference.git -b master
      - rm health-reference/build.project.xml
      - ./toolkit/phing -f health-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/dms-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/dms-reference.git -b master
      - rm dms-reference/build.project.xml
      - ./toolkit/phing -f dms-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/euandme-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/euandme-reference.git -b master
      - rm euandme-reference/build.project.xml
      - ./toolkit/phing -f euandme-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/amr-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/amr-reference.git -b master
      - rm amr-reference/build.project.xml
      - ./toolkit/phing -f amr-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/crosportal-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/crosportal-reference.git -b master
      - rm crosportal-reference/build.project.xml
      - ./toolkit/phing -f crosportal-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/primeinfrastructure-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/primeinfrastructure-reference.git -b master
      - rm primeinfrastructure-reference/build.project.xml
      - ./toolkit/phing -f primeinfrastructure-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/edpsweb-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/edpsweb-reference.git -b master
      - rm edpsweb-reference/build.project.xml
      - ./toolkit/phing -f edpsweb-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/oil-mit-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/oil-mit-reference.git -b master
      - rm oil-mit-reference/build.project.xml
      - ./toolkit/phing -f oil-mit-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/food-animals-plants-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/food-animals-plants-reference.git -b master
      - rm food-animals-plants-reference/build.project.xml
      - ./toolkit/phing -f food-animals-plants-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/esf-tc-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/esf-tc-reference.git -b master
      - rm esf-tc-reference/build.project.xml
      - ./toolkit/phing -f esf-tc-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/erasmusplus2-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/erasmusplus2-reference.git -b master
      - rm erasmusplus2-reference/build.project.xml
      - ./toolkit/phing -f erasmusplus2-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/sport-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/sport-reference.git -b master
      - rm sport-reference/build.project.xml
      - ./toolkit/phing -f sport-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/education2-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/education2-reference.git -b master
      - rm education2-reference/build.project.xml
      - ./toolkit/phing -f education2-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/easme-site-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/easme-site-reference.git -b master
      - rm easme-site-reference/build.project.xml
      - ./toolkit/phing -f easme-site-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/eych-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/eych-reference.git -b master
      - rm eych-reference/build.project.xml
      - ./toolkit/phing -f eych-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/eiopa-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/eiopa-reference.git -b master
      - rm eiopa-reference/build.project.xml
      - ./toolkit/phing -f eiopa-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/microdata-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/microdata-reference.git -b master
      - rm microdata-reference/build.project.xml
      - ./toolkit/phing -f microdata-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/taxud-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/taxud-reference.git -b master
      - rm taxud-reference/build.project.xml
      - ./toolkit/phing -f taxud-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/comm-digitaltransformation-blog-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/comm-digitaltransformation-blog-reference.git -b master
      - rm comm-digitaltransformation-blog-reference/build.project.xml
      - ./toolkit/phing -f comm-digitaltransformation-blog-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/expert-pane-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/expert-pane-reference.git -b master
      - rm expert-pane-reference/build.project.xml
      - ./toolkit/phing -f expert-pane-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/anti-fraud-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/anti-fraud-reference.git -b master
      - rm anti-fraud-reference/build.project.xml
      - ./toolkit/phing -f anti-fraud-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/education2-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/education2-reference.git -b master
      - rm education2-reference/build.project.xml
      - ./toolkit/phing -f education2-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/epale-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/epale-reference.git -b master
      - rm epale-reference/build.project.xml
      - ./toolkit/phing -f epale-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/edpb-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/edpb-reference.git -b master
      - rm edpb-reference/build.project.xml
      - ./toolkit/phing -f edpb-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/epsc-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/epsc-reference.git -b master
      - rm epsc-reference/build.project.xml
      - ./toolkit/phing -f epsc-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/eu-aid-explorer-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/eu-aid-explorer-reference.git -b master
      - rm eu-aid-explorer-reference/build.project.xml
      - ./toolkit/phing -f eu-aid-explorer-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/echo-site-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/echo-site-reference.git -b master
      - rm echo-site-reference/build.project.xml
      - ./toolkit/phing -f echo-site-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/argiculture-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/argiculture-reference.git -b master
      - rm argiculture-reference/build.project.xml
      - ./toolkit/phing -f argiculture-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/creativeeurope-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/creativeeurope-reference.git -b master
      - rm creativeeurope-reference/build.project.xml
      - ./toolkit/phing -f creativeeurope-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/safety_alerts-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/safety_alerts-reference.git -b master
      - rm safety_alerts-reference/build.project.xml
      - ./toolkit/phing -f safety_alerts-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/mossportal-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/mossportal-reference.git -b master
      - rm mossportal-reference/build.project.xml
      - ./toolkit/phing -f mossportal-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/road-safety-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/road-safety-reference.git -b master
      - rm road-safety-reference/build.project.xml
      - ./toolkit/phing -f road-safety-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/encasia-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/encasia-reference.git -b master
      - rm encasia-reference/build.project.xml
      - ./toolkit/phing -f encasia-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/eusinglesky-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/eusinglesky-reference.git -b master
      - rm eusinglesky-reference/build.project.xml
      - ./toolkit/phing -f eusinglesky-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/euprotects-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/euprotects-reference.git -b master
      - rm euprotects-reference/build.project.xml
      - ./toolkit/phing -f euprotects-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/eusdgs-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/eusdgs-reference.git -b master
      - rm eusdgs-reference/build.project.xml
      - ./toolkit/phing -f eusdgs-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/cem-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/cem-reference.git -b master
      - rm cem-reference/build.project.xml
      - ./toolkit/phing -f cem-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/commpo-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/commpo-reference.git -b master
      - rm commpo-reference/build.project.xml
      - ./toolkit/phing -f commpo-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/publicare-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/publicare-reference.git -b master
      - rm publicare-reference/build.project.xml
      - ./toolkit/phing -f publicare-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/inseparable-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/inseparable-reference.git -b master
      - rm inseparable-reference/build.project.xml
      - ./toolkit/phing -f inseparable-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/mare-emd-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/mare-emd-reference.git -b master
      - rm mare-emd-reference/build.project.xml
      - ./toolkit/phing -f mare-emd-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/mare-magaz-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/mare-magaz-reference.git -b master
      - rm mare-magaz-reference/build.project.xml
      - ./toolkit/phing -f mare-magaz-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/eurydice-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/eurydice-reference.git -b master
      - rm eurydice-reference/build.project.xml
      - ./toolkit/phing -f eurydice-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/youthwiki-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/youthwiki-reference.git -b master
      - rm youthwiki-reference/build.project.xml
      - ./toolkit/phing -f youthwiki-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/basext-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/basext-reference.git -b master
      - rm basext-reference/build.project.xml
      - ./toolkit/phing -f basext-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]
  ec-europa/jrccties-reference:
    image: fpfis/php${PHP_VERSION}-build
    secrets: [ github_api_token ]
    environment:
      - TOOLKIT_ENV_PROPS=/test/downstream/vendor/ec-europa/toolkit/includes/phing/props/drone.props
    commands:
      - git clone --depth 1 https://$${GITHUB_API_TOKEN}@github.com/ec-europa/jrccties-reference.git -b master
      - rm jrccties-reference/build.project.xml
      - ./toolkit/phing -f jrccties-reference/build.xml test-run-phpcs -D'toolkit.dir'='/test/downstream/vendor/ec-europa/toolkit' -logger phing.listener.AnsiColorLogger
    when:
      status: [ success, failure ]

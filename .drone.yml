# ==============================================================================
# Pull request clone ===========================================================
# ==============================================================================
# Use plugin to checkout pull requests for caching issue:
# https://github.com/drone/drone/issues/2390
# ==============================================================================
clone:
  git:
    image: plugins/git:next

# ==============================================================================
# Workspace location.
# ==============================================================================
workspace:
  base: /test
  path: downstream

# ==============================================================================
# Main services
# ==============================================================================
# services:
#   web:
#     image: fpfis/php56-dev
#     environment:
#       - DOCUMENT_ROOT=/test/toolkit/build
#   mysql:
#     image: percona/percona-server:5.6
#     environment:
#       - MYSQL_ALLOW_EMPTY_PASSWORD=yes

# ==============================================================================
# Downstream pipeline
# ==============================================================================
pipeline:
  trigger:
    image: plugins/downstream
    server: https://drone.fpfis.eu
    fork: true
    repositories:
      - verbruggenalex/downstream@${DOWNSTREAM_BRANCH:-toolkit/demo}
    secrets: [ downstream_token ]